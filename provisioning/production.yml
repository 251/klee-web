---
# Apply common configuration to all hosts
- hosts: all
  user: root
  vars_files:
  - vars/secrets.yml
  - vars/production.yml
  roles:
  - common

# Configure and deploy message queue servers.
- hosts: redisservers
  user: root
  vars_files:
    - vars/secrets.yml
    - vars/production.yml
  roles:
  - redis

# Configure and deploy message database servers.
- hosts: dbservers
  user: root
  vars_files:
    - vars/secrets.yml
    - vars/production.yml
  roles:
  - db

# Configure and deploy the web servers.
- hosts: webservers
  user: root
  vars_files:
    - vars/secrets.yml
    - vars/production.yml
  roles:
  - web

# Configure and deploy the worker nodes.
- hosts: workers
  user: root
  vars_files:
  - vars/secrets.yml
  - vars/production.yml
  roles:
  - worker
